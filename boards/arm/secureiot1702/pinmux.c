/*
 * Copyright (c) 2017 Crypta Labs Ltd
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#include <device.h>
#include <init.h>
#include <kernel.h>

#include "soc.h"

static int board_init(struct device *dev)
{
#ifdef CONFIG_UART_NS16550_PORT_0
	/* Set clock request, muxing and power up UART0 */
	PCR_INST->CLK_REQ_2_b.UART_0_CLK_REQ = 1;
	GPIO_100_137_INST->GPIO_104_PIN_CONTROL_b.MUX_CONTROL = 1;
	GPIO_100_137_INST->GPIO_105_PIN_CONTROL_b.MUX_CONTROL = 1;
	UART0_INST->CONFIG = 0;
	UART0_INST->ACTIVATE = 1;
#endif
#ifdef CONFIG_UART_NS16550_PORT_1
	/* Set clock request, muxing, UART1_RX_EN and power up UART1 */
	PCR_INST->CLK_REQ_2_b.UART_1_CLK_REQ = 1;
	GPIO_140_176_INST->GPIO_170_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_140_176_INST->GPIO_171_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_100_137_INST->GPIO_113_PIN_CONTROL_b.GPIO_DIRECTION = 1;
	UART1_INST->CONFIG = 0;
	UART1_INST->ACTIVATE = 1;
#endif
#ifdef DT_INST_0_MICROCHIP_CEC_QMSPI_LABEL
	/* Set clock request, muxing and drive strength */
	PCR_INST->CLK_REQ_4_b.QSPI_CLK_REQ = 1;
	GPIO_040_076_INST->GPIO_055_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_040_076_INST->GPIO_056_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_200_236_INST->GPIO_223_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_200_236_INST->GPIO_224_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_200_236_INST->GPIO_227_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_000_036_INST->GPIO_016_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_055_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_056_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_223_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_224_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_227_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_016_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
#endif
#ifdef DT_INST_0_MICROCHIP_CEC_GPSPI
	/* Set clock request and muxing */
	PCR_INST->CLK_REQ_3_b.GP_SPI0_CLK_REQ = 1;
	GPIO_000_036_INST->GPIO_003_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_000_036_INST->GPIO_004_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_000_036_INST->GPIO_034_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_000_036_INST->GPIO_036_PIN_CONTROL_b.MUX_CONTROL = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_003_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_004_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_034_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
	GPIO_PIN_CONTROL_2_INST->GPIO_036_PIN_CONTROL_2_b.DRIVE_STRENGTH = 2;
#endif
	return 0;
}

SYS_INIT(board_init, PRE_KERNEL_1, CONFIG_KERNEL_INIT_PRIORITY_DEFAULT);
